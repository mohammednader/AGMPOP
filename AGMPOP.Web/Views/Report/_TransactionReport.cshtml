@model IList<AGMPOP.BL.Models.ViewModels.TransactionCycle>
@using AGMPOP.BL.Models.ViewModels
@*@{
       // ViewData["Title"] = "TransactionReport";
    }*@

<div class="row">
    <div class="col-12 text-right">
        <span class="badge badge-primary px-4 py-2 my-3">
            <h6 class="font-weight-bold mt-1">
                Total Transaction:&nbsp;@Model?.Count
            </h6>
        </span>

    </div>


</div>
<div>

    <table id="transTable" class="table table-striped table-bordered">





        <thead>
            <tr>
                @if (ViewBag.showData == 0)
                {
                    <th class="text-center">Cycle Name</th>
                }
                <th class="text-center">From</th>
                <th class="text-center">To</th>
                <th class="text-center">Type</th>
                <th class="text-center">Created Date</th>
                <th class="text-center">Created By</th>
                <th class="text-center">Status</th>
                <th class="text-center">Total Items</th>

            </tr>
        </thead>

        <tbody>
            @if (Model?.Count > 0)
            {
                foreach (var item in Model)
                {
                    <tr>
                        @if (ViewBag.showData == 0)
                        {
                            <td class="text-center">@item.CycleName</td>
                        }
                        <td class="text-center">@item.FromUserName</td>
                        <td class="text-center">@item.ToUserName</td>
                        <td class="text-center">@(((POPEnums.TransactionTypes)item.Type).ToString())</td>
                        <td class="text-center">@item.Date.ToString()</td>
                        <td class="text-center">@item.CreatedBy</td>
                        <td class="text-center">@(((POPEnums.TransactionStatus)item.Status).ToString())</td>
                        <td class="text-center">
                            <span class="badge badge-pill badge-primary px-2 py-1" style="font-size:14px"> <a class="btn-link" onclick="showDetials(@item.TransId)" title=''>@item.TotalItem.Sum(a => a.TransAmount)</a> </span>
                        </td>

                    </tr>

                }
            }
            else
            {
                <tr>
                    @if (ViewBag.showData == 0)
                    {
                        <td colspan="7" class="text-center">
                            No transactions found
                        </td>
                    }
                    else
                    {
                        <td colspan="6" class="text-center">
                            No transactions found
                        </td>}
                </tr>
            }


        </tbody>
    </table>
</div>
<!-- Modal -->
<div id='DetialModal' class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
  
            <div class="modal-body">

                <div id='DetialContainer'>

                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>

            </div>
        </div>
    </div>
</div>

<script>
    $(document).ready(function () {
        //$('#transTable').DataTable({
        //    ordering: false,
        //    "order": [[4, "asc"]]

        //});

        //activate the tooltips after the data table is initialized
        $('[rel="tooltip"]').tooltip();

        $(window).resize(function () {
            $('#transTable').bootstrapTable('resetView');
        });
    });



</script>
<script>
        //show Product details in transaction
    function showDetials(Tid) {

        $.ajax({

            url: '@Url.Action("_TransactionDetails","Transaction")',
            method: 'Get',
            data: { Tid },
            success: function (data, jqXHR) {
                $('#DetialContainer').html(data);
                $('#DetialModal').modal('show');


            }
        });
    }

</script>


